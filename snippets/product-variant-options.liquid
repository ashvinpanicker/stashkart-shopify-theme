{% comment %}
  Renders product variant options

  Accepts:
  - product: {Object} product object.
  - option: {Object} current product_option object.
  - block: {Object} block object.
  - picker_type: {String} type of picker to dispay


  Usage:
  {% render 'product-variant-options',
    product: product,
    option: option,
    block: block
    picker_type: picker_type
  %}
{% endcomment %}
{%- liquid
  assign product_form_id = 'product-form-' | append: section.id
-%}

{%- liquid
  assign option_name_downcase = option.name | downcase
-%}

{%- if option_name_downcase == 'size' -%}
  {%- assign predefined_order = "XXS,XS,S,M,L,XL,XXL,2XL,3XL,4XL,5XL" | split: "," -%}
  {%- assign rendered_values = "" -%}
  
  {%- comment -%} First pass: render values that are in the predefined order, in that order {%- endcomment -%}
  {%- for size_name in predefined_order -%}
     {%- for value in option.values -%}
        {%- if value == size_name -%}
           {% render 'product-variant-value',
             value: value,
             option: option,
             block: block,
             picker_type: picker_type,
             product_form_id: product_form_id,
             section_id: section.id
           %}
           {%- assign rendered_values = rendered_values | append: value | append: "|||" -%}
        {%- endif -%}
     {%- endfor -%}
  {%- endfor -%}

  {%- comment -%} Second pass: render remaining values {%- endcomment -%}
  {%- for value in option.values -%}
     {%- unless rendered_values contains value -%}
         {% render 'product-variant-value',
           value: value,
           option: option,
           block: block,
           picker_type: picker_type,
           product_form_id: product_form_id,
           section_id: section.id
         %}
     {%- endunless -%}
  {%- endfor -%}
{%- else -%}
  {%- comment -%} Normal loop for non-size options {%- endcomment -%}
  {%- for value in option.values -%}
    {% render 'product-variant-value',
      value: value,
      option: option,
      block: block,
      picker_type: picker_type,
      product_form_id: product_form_id,
      section_id: section.id
    %}
  {%- endfor -%}
{%- endif -%}
